{# --- Front Matter --- #}
---
title: Dosing Data Blog # Or your actual site title
layout: base.njk # Uses _includes/base.njk
permalink: / # Generates index.html at the root
---

{# This extends the base layout. The content below goes into the 'content' block defined in base.njk #}
{% extends "base.njk" %}

{# Import your post card macro, path relative to _includes #}
{% import "macros/post-card.njk" as cards %}

{# Define the content that goes into the 'content' block of base.njk #}
{% block content %}

  {# --- START: Calculate Hero Posts --- #}
  {% set featured = collections.featuredPosts %}
  {% set centerPost = null %}
  {% for post in featured %}
    {% if post.data.featured_center === true %}
        {% set centerPost = post %}
    {% endif %}
  {% endfor %}

  {# --- Calculate sidePosts Manually (Proven Method)--- #}
  {% set potentialSidePosts = [] %}
  {% if centerPost %}
      {% for post in featured %}
          {% if post.url != centerPost.url %}
              {% set potentialSidePosts = (potentialSidePosts.push(post), potentialSidePosts) %}
          {% endif %}
      {% endfor %}
  {% else %}
      {% set potentialSidePosts = featured %}
  {% endif %}
  {% set sidePosts = potentialSidePosts | slice(0, 4) %}
  {# --- END: Calculate Hero Posts --- #}


  {# --- START SLICE DEBUG --- #}
  <div style="border: 3px solid brown; padding: 10px; margin: 15px 0; font-family: monospace; background-color: #fef;">
      <h4 style="margin-top:0; color:brown;">SLICE DEBUG</h4>
      <p><strong>sidePosts Count (Input to Slice): {{ sidePosts | length }}</strong></p>
      <hr>
      <p><strong>Testing slice(0, 2):</strong></p>
      {% set testLeft = sidePosts | slice(0, 2) %}
      <p>Count: {{ testLeft | length }}</p>
      <ul>
      {% set loopDidRunLeft = false %}
      {% for p in testLeft %}
         <li>{{ loop.index }}: {{ p.data.title | default("T MISSING", true) }}</li>
         {% set loopDidRunLeft = true %}
      {% else %}
         <li style="color:red;">LEFT SLICE LOOP FAILED ({% raw %}{% else %}{% endraw %} block)</li>
      {% endfor %}
      {% if not loopDidRunLeft and testLeft | length > 0 %}<li style="color:red;">LEFT SLICE LOOP FAILED (Silent)</li>{% endif %}
      {% if loopDidRunLeft %}<li style="color:green;">LEFT SLICE LOOP SUCCEEDED</li>{% endif %}
      </ul>
       <hr>
      <p><strong>Testing slice(2, 4):</strong></p>
      {% set testRight = sidePosts | slice(2, 4) %}
      <p>Count: {{ testRight | length }}</p>
      <ul>
      {% set loopDidRunRight = false %}
      {% for p in testRight %}
         <li>{{ loop.index }}: {{ p.data.title | default("T MISSING", true) }}</li>
          {% set loopDidRunRight = true %}
      {% else %}
         <li style="color:red;">RIGHT SLICE LOOP FAILED ({% raw %}{% else %}{% endraw %} block)</li>
      {% endfor %}
      {% if not loopDidRunRight and testRight | length > 0 %}<li style="color:red;">RIGHT SLICE LOOP FAILED (Silent)</li>{% endif %}
      {% if loopDidRunRight %}<li style="color:green;">RIGHT SLICE LOOP SUCCEEDED</li>{% endif %}
      </ul>
       <hr>
       <p><strong>Re-checking sidePosts after slicing (Count: {{ sidePosts | length }})</strong></p>
       <p><em>(This confirms slice doesn't modify original)</em></p>

  </div>
  {# --- END SLICE DEBUG --- #}


  {# --- Temporarily disable rendering --- #}
  <p style="text-align: center; color: gray;">(Rendering temporarily disabled to focus on slice debug)</p>
  {% set leftPosts = [] %}{# Prevent errors lower down #}
  {% set rightPosts = [] %}{# Prevent errors lower down #}


  {# --- START: Render Hero Section Placeholder --- #}
   {# {% if centerPost or sidePosts.length > 0 %} ... {% endif %} #}
  {# --- END: Render Hero Section Placeholder --- #}


  {# --- START: Rest of the content Placeholder --- #}
  {# <h2>More Posts</h2> ... #}
  {# --- END: Rest of the content Placeholder--- #}

{% endblock %}